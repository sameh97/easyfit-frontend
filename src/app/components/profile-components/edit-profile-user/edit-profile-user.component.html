<div class="center">
    <h2 mat-dialog-title>Edit user </h2>
</div>

<form *ngIf="updateUserForm" name="updateUserForm" #theForm="ngForm" [formGroup]="updateUserForm" (ngSubmit)="update()">
    <div class="flex-container">

        <div>
            <div class="flex-container-inside-row">
                <div>
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>User first name</mat-label>
                        <input matInput type="text" [(ngModel)]="user.firstName" name="firstName" formControlName="firstName" placeholder="Enter user's first name please">
                    </mat-form-field>
                    <div *ngIf="isInputValidationFailed(updateUserForm.controls.firstName)" class="validation-err-container">

                        <div *ngIf="updateUserForm.controls.firstName.errors.nameNotValid">
                            <small> User first name is not valid.
              </small>
                        </div>
                        <div *ngIf="updateUserForm.controls.firstName.errors.required">
                            <small> User first name is required.
              </small>
                        </div>
                    </div>
                </div>
                <div>
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>User last name</mat-label>
                        <input matInput type="text" [(ngModel)]="user.lastName" name="lastName" formControlName="lastName" placeholder="Enter user's last name please">
                    </mat-form-field>
                    <div *ngIf="isInputValidationFailed(updateUserForm.controls.lastName)" class="validation-err-container">

                        <div *ngIf="updateUserForm.controls.lastName.errors.nameNotValid">
                            <small> User last name is not valid.
              </small>
                        </div>
                        <div *ngIf="updateUserForm.controls.lastName.errors.required">
                            <small> User last name is required.
              </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div>
            <mat-form-field class="example-full-width" appearance="fill">
                <mat-label>Email</mat-label>
                <input readonly matInput type="email" [(ngModel)]="user.email" name="email" formControlName="email" placeholder="Enter user's email please">
            </mat-form-field>
            <div *ngIf="isInputValidationFailed(updateUserForm.controls.email)" class="validation-err-container">

                <div *ngIf="updateUserForm.controls.email.errors.email">
                    <small> Email is not valid.
          </small>
                </div>
                <div *ngIf="updateUserForm.controls.email.errors.required">
                    <small> Email is required.
          </small>
                </div>
            </div>
        </div>

        <div>
            <div class="flex-container-inside-row">
                <div>
                    <mat-form-field class="example-full-width" appearance="outline">
                        <mat-label>Password</mat-label>
                        <input formControlName="password" [(ngModel)]="user.password" matInput [type]=" hide ? 'password' : 'text'" required />
                        <button type="button" mat-icon-button matSuffix (click)="hide = !hide" [attr.aria-label]="'Hide Password'" [attr.aria-pressed]="hide">
              <mat-icon>
                {{hide ? 'visibility_off' : 'visibility'}}
              </mat-icon>
            </button>

                    </mat-form-field>
                    <div *ngIf="isInputValidationFailed(updateUserForm.controls.password)" class="validation-err-container">
                        <div *ngIf="updateUserForm.controls.password.errors.required"><small>Password is required</small></div>
                        <div *ngIf="updateUserForm.controls.password.errors.minlength"><small>Password must be at least
                {{ updateUserForm.controls.password.errors.minlength.requiredLength }} characters</small>
                        </div>
                    </div>
                </div>
                <div>
                    <mat-form-field class="example-full-width" appearance="outline">
                        <mat-label>Confirm Password</mat-label>
                        <input formControlName="confirmPassword" ngModel matInput [type]=" hide ? 'password' : 'text'" required />
                        <button type="button" mat-icon-button matSuffix (click)="hide = !hide" [attr.aria-label]="'Hide Password'" [attr.aria-pressed]="hide">
              <mat-icon>
                {{hide ? 'visibility_off' : 'visibility'}}
              </mat-icon>
            </button>

                    </mat-form-field>

                    <div *ngIf="!passwordsMatch(updateUserForm) && updateUserForm.controls.confirmPassword.touched" class="validation-err-container">
                        <small>Passwords do not match</small>
                    </div>
                </div>
            </div>
        </div>

        <div>
            <div class="flex-container-inside-row">
                <div>
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>User phone</mat-label>
                        <input matInput type="text" [(ngModel)]="user.phone" name="phone" formControlName="phone" placeholder="Enter user's phone please">
                    </mat-form-field>
                    <div *ngIf="isInputValidationFailed(updateUserForm.controls.phone)" class="validation-err-container">

                        <div *ngIf="updateUserForm.controls.phone.errors.gymPhoneNotValid">
                            <small> User phone is not valid.
              </small>
                        </div>
                        <div *ngIf="updateUserForm.controls.phone.errors.required">
                            <small> User phone is required.
              </small>
                        </div>
                    </div>
                </div>
                <div>
                    <mat-form-field appearance="fill" class="example-full-width">
                        <mat-label>User birth day</mat-label>
                        <input formControlName="birthDay" matInput [(ngModel)]="user.birthDay" [matDatepicker]="picker">
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>
                    <div *ngIf="isInputValidationFailed(updateUserForm.controls.birthDay)" class="validation-err-container">

                        <div *ngIf="updateUserForm.controls.birthDay.errors.ageUnder">
                            <small> User must be at least 16 years old
              </small>
                        </div>
                        <div *ngIf="updateUserForm.controls.birthDay.errors.required">
                            <small> User birth day is required.
              </small>
                        </div>
                        <div *ngIf="updateUserForm.controls.birthDay.errors.birthDayNotValid">
                            <small> User birth day is not valid.
              </small>
                        </div>


                    </div>
                </div>
            </div>
        </div>
        <div>
            <div class="flex-container-inside-row">
                <div>
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>User address</mat-label>
                        <input matInput type="text" [(ngModel)]="user.address" name="address" formControlName="address" placeholder="Enter user's address please">
                    </mat-form-field>
                    <div *ngIf="isInputValidationFailed(updateUserForm.controls.address)" class="validation-err-container">
                        <div *ngIf="updateUserForm.controls.address.errors.required">
                            <small> User address is required.
              </small>
                        </div>
                    </div>

                </div>
                <div></div>
            </div>
        </div>
        <div> <label for="image">Image</label>
            <input type="file" [(ngModel)]="user.imageURL" formControlName="imageURL" placeholder="Image" accept=".png, .jpg, .jpeg" (change)="handleSelectedImage($event.target.files)">
        </div>
        <div> <button id="update-user-btn" class="btn btn-primary btn-block" [disabled]="!theForm.valid">
        Edit user </button>
        </div>

    </div>


</form>