<div class="center">
    <h2 mat-dialog-title>Add new job </h2>
</div>

<form *ngIf="addScheduledJobForm && scheduledJob" #theForm="ngForm" [formGroup]="addScheduledJobForm" (ngSubmit)="create()">

    <mat-grid-list cols="4" rowHeight="60px">
        <mat-grid-tile [colspan]="2" [rowspan]="1" [style.background]="lightblue">
            <mat-form-field class="example-full-width" appearance="fill">
                <mat-label>Machine Serial number</mat-label>
                <input matInput type="text" [(ngModel)]="scheduledJob.machineSerialNumber" name="machineSerialNumber" formControlName="machineSerialNumber" placeholder="Machine Serial number">
            </mat-form-field>

        </mat-grid-tile>
        <mat-grid-tile [colspan]="2" [rowspan]="1" [style.background]="lightblue">
            <small *ngIf=" addScheduledJobForm.controls.machineSerialNumber.touched && addScheduledJobForm.controls.machineSerialNumber.errors?.machineNotExist" class="text-danger">
        Machine with serial number: {{addScheduledJobForm.controls.machineSerialNumber.errors?.machineNotExist.value }}
        <br>
        does not exist
      </small>
        </mat-grid-tile>



        <mat-grid-tile [colspan]="2" [rowspan]="1" [style.background]="lightblue">
            <mat-form-field appearance="fill">
                <mat-label>Mission</mat-label>
                <mat-select formControlName="jobID" [(ngModel)]="scheduledJob.jobID">
                    <mat-option value="1">Clean</mat-option>
                    <mat-option value="2">Service</mat-option>
                </mat-select>
            </mat-form-field>
        </mat-grid-tile>

        <mat-grid-tile [colspan]="2" [rowspan]="1" [style.background]="lightblue">

        </mat-grid-tile>

        <mat-grid-tile [colspan]="4" [rowspan]="1" [style.background]="lightblue">
            <!-- <mat-form-field class="wide">
          <mat-label>Start time</mat-label>
          <input [(ngModel)]="scheduledJob.startTime" type="date" name="startTime" formControlName="startTime" matInput
            placeholder="Start time">
          <mat-icon matSuffix>sentiment_very_satisfied</mat-icon>
          <mat-hint>Hint</mat-hint>
        </mat-form-field> -->

            <mat-form-field class="wide">
                <input matInput [ngxMatDatetimePicker]="startTimePicker" placeholder="Choose start time" [(ngModel)]="scheduledJob.startTime" formControlName="startTime" [min]="minDate" [max]="maxDate" [disabled]="disabled">
                <mat-datepicker-toggle matSuffix [for]="startTimePicker"></mat-datepicker-toggle>
                <ngx-mat-datetime-picker #startTimePicker [showSpinners]="showSpinners" [showSeconds]="showSeconds" [stepHour]="stepHour" [stepMinute]="stepMinute" [stepSecond]="stepSecond" [touchUi]="touchUi" [color]="color" [enableMeridian]="enableMeridian" [disableMinute]="disableMinute"
                    [hideTime]="hideTime">
                </ngx-mat-datetime-picker>
            </mat-form-field>

        </mat-grid-tile>

        <mat-grid-tile [colspan]="4" [rowspan]="1" [style.background]="lightblue">
            <!-- <mat-form-field class="wide">
          <mat-label>End time</mat-label>
          <input [(ngModel)]="scheduledJob.endTime" type="date" name="endTime" formControlName="endTime" matInput
            placeholder="End time">
          <mat-icon matSuffix>sentiment_very_satisfied</mat-icon>
          <mat-hint>Hint</mat-hint>
        </mat-form-field> -->

            <mat-form-field class="wide">
                <input matInput [ngxMatDatetimePicker]="endTimePicker" placeholder="Choose end time" [(ngModel)]="scheduledJob.endTime" formControlName="endTime" [min]="minDate" [max]="maxDate" [disabled]="disabled">
                <mat-datepicker-toggle matSuffix [for]="endTimePicker"></mat-datepicker-toggle>
                <ngx-mat-datetime-picker #endTimePicker [showSpinners]="showSpinners" [showSeconds]="showSeconds" [stepHour]="stepHour" [stepMinute]="stepMinute" [stepSecond]="stepSecond" [touchUi]="touchUi" [color]="color" [enableMeridian]="enableMeridian" [disableMinute]="disableMinute"
                    [hideTime]="hideTime">
                </ngx-mat-datetime-picker>
            </mat-form-field>


        </mat-grid-tile>

        <mat-grid-tile [colspan]="2" [rowspan]="1" [style.background]="lightblue">
            <mat-form-field class="frequency-full-width" appearance="fill">
                <mat-label>Scheduler Frequency (in days)</mat-label>
                <input type="number" [(ngModel)]="scheduledJob.daysFrequency" formControlName="daysFrequency" matInput placeholder="Frequency" value="1">
            </mat-form-field>
            <!--  (ngModelChange)="onFrequencySelected($event)" -->
            <!-- TODO: check if the days is less than the days range between start and end date  -->
        </mat-grid-tile>

        <mat-grid-tile [colspan]="2" [rowspan]="1" [style.background]="lightblue">

        </mat-grid-tile>

        <mat-grid-tile [colspan]="2" [rowspan]="1" [style.background]="lightblue">
            <mat-form-field appearance="fill">
                <mat-label>Job Status</mat-label>
                <mat-select formControlName="isActive" [(ngModel)]="scheduledJob.isActive">
                    <mat-option value="true">Enabled</mat-option>
                    <mat-option value="false">Disabled</mat-option>
                </mat-select>
            </mat-form-field>

        </mat-grid-tile>

        <mat-grid-tile [colspan]="2" [rowspan]="1" [style.background]="lightblue">

        </mat-grid-tile>


    </mat-grid-list>

    <button id="update-job-btn" class="btn btn-primary btn-block" [disabled]="!theForm.valid">
    Add New Job </button>

</form>